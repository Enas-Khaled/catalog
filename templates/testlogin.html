 <!DOCTYPE html>
  <html>
  <head>
  <!--LOAD PRE-REQUISITES FOR GOOGLE SIGN IN -->
  <script src="https://ajax.googleapis.com/.../jquery/1.12.4/jquery.min.js"></script>
  <script src="https://apis.google.com/js/client:platform.js?onload=start" async defer></script>
  <script>
  function start() {
  gapi.load('auth2', function() {
  auth2 = gapi.auth2.init({
  client_id: '://369549596364-v7a1b41n9d9i7tclqmljil4hhusjgrb2.apps.goo...'
  });
  });
  }
  </script>
  <!-- END PRE-REQUISITES FOR GOOGLE SIGN IN -->
  </head>
  <body>
  <button id="signinButton">Google Signin</button>
  <div id="result"></div>
  <script>
  $('#signinButton').click(function () {
  function signInCallback(authResult) {
  if (authResult['code']) {
  // Hide the sign-in button now that the user is authorized
  $('#signinButton').attr('style', 'display:none');
  // Send the one-time-use code to the server, if the server responds, write a 'login successful' message to the web page and then redirect back to the main restaurants page
  $.ajax({
  type: 'POST',
  url: '/gconnect?state={{STATE}}',
  processData: false,
  data: authResult['code'],
  contentType: 'application/octet-stream; charset=utf-8',
  success: function (result) {
  // Handle or verify the server response if necessary.
  if (result) {
  $('#result').html('Login Successful!</br>' + result + '</br>Redirecting...');
  setTimeout(function () {
  window.location.href = "/";
  }, 4000);
  } else if (authResult['error']) {
  console.log('There was an error: ' + authResult['error']);
  } else {
  $('#result').html('Failed to make a server-side call. Check your configuration and console.');
  }
  }
  });
  }
  }
  auth2.grantOfflineAccess().then(signInCallback);
  })
  </script>
  <!--END GOOGLE PLUS SIGN IN -->
  </body>
  </html>




  pip install werkzeug==0.8.3
pip install flask==0.9
pip install Flask-Login==0.1.3




IMPORTANT: Depending on the version of Flask you have, you may or may not be able to store a credentials object in the login_session the same way that Lorenzo does. You may get the following error:

OAuth2Credentials object is not JSON serializable

What should you do to fix this? There are three options:

Rather than storing the entire credentials object you can store just the access token instead. It can be accessed using credentials.access_token.
The OAuth2Credentials class comes with methods that can help you. The .to_json() and .from_json() methods can help you store and retrieve the credentials object in json format.
Update your versions of Flask, _ and _ to match Lorenzo's. Use the following commands:


<body>  


    <!-- GOOGLE PLUS SIGN IN-->
    
              
              <div id="signinButton">
              <span class="g-signin"
                data-scope="openid email"
                data-clientid="819554131496-hv51qnphnm9so2hd0khrnls5qg0a73sv.apps.googleusercontent.com"
                data-redirecturi="postmessage"
                data-accesstype="offline"
                data-cookiepolicy="single_host_origin"
                data-callback="signInCallback"
                data-approvalprompt="force">
              </span>
            </div>
    
    <div id="result"></div>
    
    <script>
    function signInCallback(authResult) {
      if (authResult['code']) {
    
        // Hide the sign-in button now that the user is authorized
        $('#signinButton').attr('style', 'display: none');
    
        // Send the one-time-use code to the server, if the server responds, write a 'login successful' message to the web page and then redirect back to the main acategory page
        $.ajax({
          type: 'POST',
          url: '/gconnect?state={{STATE}}',
          processData: false,
          data: authResult['code'],
          contentType: 'application/octet-stream; charset=utf-8',
          success: function(result) {
            // Handle or verify the server response if necessary.
            if (result) {
              $('#result').html('Login Successful!</br>'+ result + '</br>Redirecting...')
             setTimeout(function() {
              window.location.href = "/category";
             }, 4000);
              
    
          } else if (authResult['error']) {
    
        console.log('There was an error: ' + authResult['error']);
      } else {
            $('#result').html('Failed to make a server-side call. Check your configuration and console.');
             }
    
          }
          
      }); } }
    </script>
    
    
    
    <!--END GOOGLE PLUS SIGN IN -->
    
      </body>
    